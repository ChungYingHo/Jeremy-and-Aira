---
import '@/styles/tailwind.css'
import '@/styles/main.scss'
import Menu from '@/components/Menu.svelte'
import { useMenu } from '@/utils/useMenu'

const { menu } = await useMenu()
const currentPath = Astro.url.pathname

interface Props {
  title?: string
  description?: string
}

const {
  title = 'Jeremy & Aira',
  description = "Jeremy & Aira's Tech Blog",
} = Astro.props
---

<!doctype html>
<html lang="zh-TW" class="dark scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content={description} />
    <title>{title}</title>

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" href="/favicon.ico" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
  </head>

  <body
    class="
      min-h-screen
      flex
      flex-col
      text-slate-300
      bg-[#050505]
      antialiased
      selection:bg-indigo-500/30
      selection:text-indigo-200
      relative
    "
  >
    <div class="fixed inset-0 z-[-1] w-full h-full pointer-events-none">
      <div class="absolute inset-0 opacity-[0.03] mix-blend-overlay bg-noise"></div>
      
      <div class="absolute inset-0 bg-grid-pattern opacity-[0.02]"></div>

      <div class="absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-blue-600/20 blur-[120px] rounded-full mix-blend-screen animate-pulse-slow"></div>
      <div class="absolute bottom-[-10%] right-[-5%] w-[600px] h-[600px] bg-purple-600/10 blur-[120px] rounded-full mix-blend-screen"></div>
    </div>

    <Menu client:load rootItems={menu} currentPath={currentPath} />

    <main class="flex-1 w-full max-w-5xl mx-auto px-6 pt-32 pb-24 relative z-10">
      <slot />
    </main>
  </body>
</html>

<style is:global>
  :root {
    color-scheme: dark;
  }

  html {
    font-family: 'Inter', 'Noto Sans TC', system-ui, sans-serif;
    scroll-behavior: smooth;
  }

  /* 生成 SVG 噪點 (比圖片更輕量) 
    這會讓背景看起來更有質感，不像單純的 CSS 漸層
  */
  .bg-noise {
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
  }

  /* 極簡網格背景 
    讓頁面看起來更有工程師/技術感
  */
  .bg-grid-pattern {
    background-size: 40px 40px;
    background-image: linear-gradient(to right, #ffffff 1px, transparent 1px),
      linear-gradient(to bottom, #ffffff 1px, transparent 1px);
  }

  /* 緩慢呼吸動畫 
    讓背景不那麼死板
  */
  @keyframes pulse-slow {
    0%, 100% { opacity: 0.4; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.1); }
  }
  .animate-pulse-slow {
    animation: pulse-slow 8s ease-in-out infinite;
  }

  /* Scrollbar 美化 - 更細緻 */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: #262626;
    border-radius: 4px;
    border: 1px solid #050505; /* 增加邊框讓它看起來分離 */
  }

  ::-webkit-scrollbar-thumb:hover {
    background: #404040;
  }
</style>